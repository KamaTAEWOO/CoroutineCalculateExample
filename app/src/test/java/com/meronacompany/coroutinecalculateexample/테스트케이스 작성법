// í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±ë²•

/**
 * âœ… í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë€?
 * í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤(Test Case)ëŠ” ì½”ë“œì˜ íŠ¹ì • ê¸°ëŠ¥/ë¡œì§ì´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ”ì§€ ê²€ì¦í•˜ê¸° ìœ„í•´ ì‘ì„±í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.
 * ì¼ë°˜ì ìœ¼ë¡œ ìœ ë‹› í…ŒìŠ¤íŠ¸, í†µí•© í…ŒìŠ¤íŠ¸, UI í…ŒìŠ¤íŠ¸ ë“±ì´ ìˆìœ¼ë©°, ì—¬ê¸°ì„œëŠ” ìœ ë‹› í…ŒìŠ¤íŠ¸ ì¤‘ì‹¬ìœ¼ë¡œ ì„¤ëª…í•©ë‹ˆë‹¤.
 */

/**
 * ğŸ“¦ JUnit ë° ì½”ë£¨í‹´ í…ŒìŠ¤íŠ¸ ì–´ë…¸í…Œì´ì…˜ ì •ë¦¬
 *
 * @Test             : í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ í‘œì‹œ
 * @Before           : ê° í…ŒìŠ¤íŠ¸ ì „ ì‹¤í–‰ (JUnit4)
 * @After            : ê° í…ŒìŠ¤íŠ¸ í›„ ì‹¤í–‰ (JUnit4)
 * @BeforeEach       : ê° í…ŒìŠ¤íŠ¸ ì „ ì‹¤í–‰ (JUnit5)
 * @AfterEach        : ê° í…ŒìŠ¤íŠ¸ í›„ ì‹¤í–‰ (JUnit5)
 * @BeforeClass      : ëª¨ë“  í…ŒìŠ¤íŠ¸ ì „ì— 1íšŒ ì‹¤í–‰
 * @AfterClass       : ëª¨ë“  í…ŒìŠ¤íŠ¸ í›„ì— 1íšŒ ì‹¤í–‰
 * @Ignore           : í•´ë‹¹ í…ŒìŠ¤íŠ¸ ë¬´ì‹œ
 * @ParameterizedTest: ì—¬ëŸ¬ ê°’ì— ëŒ€í•´ ë°˜ë³µ í…ŒìŠ¤íŠ¸ (JUnit5)
 * @RunWith          : í…ŒìŠ¤íŠ¸ ì‹¤í–‰ê¸° ì„¤ì • (ex: Mockito ì‚¬ìš© ì‹œ)
 */

/**
 * âœ… Gradle ì˜ì¡´ì„± ì¶”ê°€ ì˜ˆì‹œ (JUnit4 ê¸°ì¤€)
 *
 * testImplementation 'junit:junit:4.13.2'
 * testImplementation 'org.jetbrains.kotlinx:kotlinx-coroutines-test:1.7.3'
 * testImplementation 'org.mockito:mockito-core:4.8.1'
 */

/**
 * âœï¸ ê¸°ë³¸ ìœ ë‹› í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ
 */
class Calculator {
    fun add(a: Int, b: Int): Int = a + b
}

class CalculatorTest {

    private lateinit var calculator: Calculator

    @Before
    fun setUp() {
        calculator = Calculator()
    }

    @Test
    fun `ë”í•˜ê¸° ê¸°ëŠ¥ì´ ì •ìƒ ë™ì‘í•œë‹¤`() {
        val result = calculator.add(2, 3)
        assertEquals(5, result)
    }
}

/**
 * ğŸ§ª ì½”ë£¨í‹´ í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ
 */
class CoroutineTest {

    @Test
    fun `ì½”ë£¨í‹´ì´ 100ms í›„ì— ê°’ì„ ë°˜í™˜í•œë‹¤`() = runTest {
        val result = async {
            delay(100)
            return@async "ì™„ë£Œ"
        }
        assertEquals("ì™„ë£Œ", result.await())
    }
}

/**
 * ğŸ§© ì˜ˆì™¸ í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ
 */
class ExceptionTest {

    @Test(expected = IllegalArgumentException::class)
    fun `ìŒìˆ˜ë¥¼ ë„£ìœ¼ë©´ ì˜ˆì™¸ë¥¼ ë˜ì§„ë‹¤`() {
        SomeClass().requirePositive(-1)
    }

    @Test
    fun `ì˜ˆì™¸ë¥¼ assertThrowsë¡œ í™•ì¸`() {
        assertThrows<IllegalArgumentException> {
            SomeClass().requirePositive(-1)
        }
    }
}

/**
 * ğŸ“Œ Mockitoë¥¼ í™œìš©í•œ í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ
 */
@RunWith(MockitoJUnitRunner::class)
class LoginTest {

    @Mock lateinit var repository: UserRepository
    @InjectMocks lateinit var loginManager: LoginManager

    @Test
    fun `ë¡œê·¸ì¸ì´ ì„±ê³µí•˜ë©´ trueë¥¼ ë°˜í™˜`() {
        `when`(repository.login("id", "pw")).thenReturn(true)
        assertTrue(loginManager.login("id", "pw"))
    }
}